# Code hunt 1

## 1. 서론

본 보고서는 “색깔 여행(Colorful Tour)” 문제를 해결하기 위한 알고리즘의 개요와, 문제에서 제시된 두 번째 예제 입력이 실제로는 모순을 포함하고 있음을 설명한다.  
문제 요약은 다음과 같다. 정점에 1부터 K까지 색깔이 주어지고, 방향 그래프가 구성되어 있다. 1부터 K까지 모든 색깔을 적어도 한 번씩 방문하는 경로 중에서 간선 비용 합이 최소인 값을 찾아야 하며, 만약 그런 경로가 전혀 없다면 -1을 출력한다.

문제에서 주어진 두 가지 예제 중, 첫 번째 예제는 알고리즘을 통해 최소 비용이 7로 올바르게 계산되지만, 두 번째 예제는 “-1”이 예시 출력으로 주어져 있음에도 불구하고 실제로는 모든 색깔을 방문하는 경로가 존재한다. 이 보고서는 해당 모순을 논리적으로 밝히고, 왜 -1이 아니라 다른 비용이 나오는지에 대한 이유를 기술한다.

---

## 2. 알고리즘 개요

### 2.1 아이디어

1. **비트마스크**를 통해 색깔 방문 상태를 관리한다. K <= 10이므로 방문한 색깔들을 2^K로 나타낼 수 있다.
2. 상태 `dist[v][mask]`를 “정점 v에 있으면서, 방문 색깔 상태가 mask일 때의 최소 비용”으로 정의한다.
3. **방향 그래프에서의 최단 경로 알고리즘(다익스트라)**를 확장하여, (정점, 색깔비트마스크) 쌍을 노드처럼 다룬다. 정점 v에서 w로 이동할 때, w의 색깔 비트를 추가한 mask로 전이시킨다.
4. 모든 색깔(1부터 K까지)을 방문했는지는 최종적으로 비트마스크가 `(1 << K) - 1`인지로 확인한다. `dist[v][(1 << K) - 1]` 중 최소값이 답이 된다. 경로가 없으면 -1을 출력한다.

### 2.2 복잡도

상태의 개수는 `N * (2^K)`이 된다. `N <= 1000`, `M <= 5000`, `K <= 10` 범위 내에서 다익스트라의 우선순위 큐 사용 시 `O(M log(N 2^K))` 정도이므로 충분히 계산 가능하다.

---

## 3. 예제 2의 모순

문제에서 두 번째 예제로 제시된 입력은 다음과 같은 그래프를 구성한다.

- **정점 색깔**

  - 1번 정점: 색깔 1
  - 2번 정점: 색깔 2
  - 3번 정점: 색깔 3
  - 4번 정점: 색깔 3

- **간선 방향 및 비용**
  - 1 -> 2 (2), 2 -> 3 (2), 2 -> 4 (5), 3 -> 4 (1)

이를 보면, 정점 1에서 2로 이동해 비용 2를 쓰고, 이어서 정점 2에서 3으로 이동해 비용 2를 더하면 총 비용 4로 색깔 1, 2, 3을 모두 방문한다. 따라서 “모든 색깔을 방문할 수 없다”는 상황이 아니다. 문제 설명상 “모든 색깔 방문이 불가능할 때 -1”이라 했으므로, 실제로는 경로가 존재하므로 -1이 될 수 없다. 이 예제가 -1을 출력해 달라고 하는 것은 문제의 조건과 충돌한다.

---

## 4. 결론

1. **비트마스크 + 다익스트라** 방식으로 “모든 색깔을 방문하는 최소 비용 경로”를 구하는 알고리즘은 정상적이다. 첫 번째 예제에서는 최소 비용이 7로 예제 출력과 일치한다.
2. 두 번째 예제 그래프에서는 색깔 1, 2, 3을 방문하는 경로(예: `1 -> 2 -> 3`)가 존재하므로 -1이 될 수 없다. 따라서 주어진 예제 2의 출력이 -1이라는 것은 문제 본문과 불일치하거나 추가 제약이 누락된 것으로 보인다.
3. 결론적으로, 예제 2는 문제에서 제시된 조건만으로는 -1을 만족시키기 어렵다. 해당 예제가 잘못 기재되었거나, 실제로는 특별한 추가 규칙이 있어야만 -1이 될 것이다. 하지만 문제의 원문에 그러한 제약이 적시되지 않았으므로, 현 상태에서는 모순이 존재한다고 판단된다.

끝.
